{"ast":null,"code":"import _asyncToGenerator from\"/Users/taiki/Desktop/household/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/taiki/Desktop/household/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/taiki/Desktop/household/frontend/node_modules/@babel/runtime/regenerator/index.js\";import React,{useState,useEffect,useContext}from'react';import{useHistory,Link}from'react-router-dom';import Cookies from'js-cookie';import{AuthContext}from'../../App';// api\nimport{getAllHousehold}from'../../api/household';// component\nimport{signOut}from'../../api/auth';import MobileModal from'./MobileModal/MobileModal';//css\nimport style from'./Header.module.scss';// image\nimport MobileMenuButton from'../../image/mobileMenu.png';import MobileMenuCrossButton from'../../image/mobilemenu_crossmark.png';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Header=function Header(){var history=useHistory();var _useContext=useContext(AuthContext),isSignedIn=_useContext.isSignedIn,setIsSignedIn=_useContext.setIsSignedIn,currentUser=_useContext.currentUser;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),modalOpen=_useState2[0],setModalOpen=_useState2[1];var initialHousehold={id:1,name:\"\",amountPlanned:1,userId:0,createdAt:new Date(),updatedAt:new Date()};var _useState3=useState([initialHousehold]),_useState4=_slicedToArray(_useState3,2),households=_useState4[0],setHouseholds=_useState4[1];// 家計簿一覧の取得\nvar handleGetAllHousehold=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(currentUser){_context.next=2;break;}return _context.abrupt(\"return\");case 2:_context.prev=2;_context.next=5;return getAllHousehold(currentUser.id);case 5:res=_context.sent;if((res===null||res===void 0?void 0:res.status)===200){setHouseholds(res.data);};_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](2);console.log(_context.t0);case 13:case\"end\":return _context.stop();}}},_callee,null,[[2,10]]);}));return function handleGetAllHousehold(){return _ref.apply(this,arguments);};}();var handleModal=function handleModal(){setModalOpen(!modalOpen);};var handleSignout=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return signOut();case 3:res=_context2.sent;if(res.data.success===true){Cookies.remove(\"_access_token\");Cookies.remove(\"_client\");Cookies.remove(\"_uid\");setIsSignedIn(false);history.push(\"/signin\");console.log('サインアウトしました');}else{console.log('サインアウトに失敗しました');alert('サインアウトできませんでした');}_context2.next=11;break;case 7:_context2.prev=7;_context2.t0=_context2[\"catch\"](0);console.log(_context2.t0);alert('サインアウトできませんでした');case 11:case\"end\":return _context2.stop();}}},_callee2,null,[[0,7]]);}));return function handleSignout(){return _ref2.apply(this,arguments);};}();useEffect(function(){handleGetAllHousehold();// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:style.header,children:[/*#__PURE__*/_jsx(\"h1\",{children:/*#__PURE__*/_jsx(Link,{to:\"/\",children:\"\\u308F\\u305F\\u3057\\u306E\\u5BB6\\u8A08\\u7C3F\"})}),/*#__PURE__*/_jsx(\"div\",{className:style.mobilemenu,children:/*#__PURE__*/_jsx(\"img\",{onClick:handleModal,className:modalOpen?style.crossmark:style.mobilemenuBack,src:modalOpen?MobileMenuCrossButton:MobileMenuButton,alt:\"header menu\"})}),/*#__PURE__*/_jsxs(\"ul\",{className:style.pcmenu,children:[isSignedIn&&households?/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(Link,{to:\"/\",children:\"\\u5BB6\\u8A08\\u7C3F\\u3092\\u9078\\u3076\"})}):\"\",/*#__PURE__*/_jsx(\"li\",{className:style.sign,children:isSignedIn?/*#__PURE__*/_jsx(\"span\",{onClick:handleSignout,children:\"\\u30B5\\u30A4\\u30F3\\u30A2\\u30A6\\u30C8\"}):/*#__PURE__*/_jsx(Link,{to:\"/signin\",children:\"\\u30B5\\u30A4\\u30F3\\u30A4\\u30F3\"})})]})]}),/*#__PURE__*/_jsx(MobileModal,{modalOpen:modalOpen,setModalOpen:setModalOpen})]});};export default Header;","map":{"version":3,"sources":["/Users/taiki/Desktop/household/frontend/src/components/Header/Header.tsx"],"names":["React","useState","useEffect","useContext","useHistory","Link","Cookies","AuthContext","getAllHousehold","signOut","MobileModal","style","MobileMenuButton","MobileMenuCrossButton","Header","history","isSignedIn","setIsSignedIn","currentUser","modalOpen","setModalOpen","initialHousehold","id","name","amountPlanned","userId","createdAt","Date","updatedAt","households","setHouseholds","handleGetAllHousehold","res","status","data","console","log","handleModal","handleSignout","success","remove","push","alert","header","mobilemenu","crossmark","mobilemenuBack","pcmenu","sign"],"mappings":"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","sourcesContent":["import React, { useState, useEffect,  useContext } from 'react';\nimport { useHistory, Link } from 'react-router-dom';\nimport Cookies from 'js-cookie';\nimport { AuthContext } from '../../App';\n\n// api\nimport { getAllHousehold } from '../../api/household';\n\n// component\nimport { signOut } from '../../api/auth';\nimport MobileModal from './MobileModal/MobileModal';\n\n//css\nimport style from './Header.module.scss';\n\n// image\nimport MobileMenuButton from '../../image/mobileMenu.png';\nimport MobileMenuCrossButton from '../../image/mobilemenu_crossmark.png';\n\n\nconst Header: React.FC = () => {\n  const history = useHistory();\n    const { \n    isSignedIn, \n    setIsSignedIn,\n    currentUser,\n  } = useContext(AuthContext);\n  const [modalOpen, setModalOpen] = useState(false);\n\n  const initialHousehold = {\n    id: 1,\n    name: \"\",\n    amountPlanned: 1,\n    userId: 0,\n    createdAt: new Date(),\n    updatedAt: new Date()\n  };\n\n  const [households, setHouseholds] = useState([initialHousehold]);\n\n  // 家計簿一覧の取得\n  const handleGetAllHousehold = async () => {\n    if(!currentUser) return;\n    try {\n      const res = await getAllHousehold(currentUser.id);\n      if(res?.status === 200) {\n        setHouseholds(res.data);\n      };\n    } catch (err: any) {\n      console.log(err);\n    }\n  };\n\n\n  const handleModal = () => {\n    setModalOpen(!modalOpen);\n  };\n\n  const handleSignout = async () => {\n    try {\n      const res = await signOut();\n  \n      if(res.data.success === true) {\n        Cookies.remove(\"_access_token\");\n        Cookies.remove(\"_client\");\n        Cookies.remove(\"_uid\");\n  \n        setIsSignedIn(false);\n        history.push(\"/signin\");\n  \n        console.log('サインアウトしました')\n      } else {\n        console.log('サインアウトに失敗しました')\n        alert('サインアウトできませんでした')\n      }\n    } catch (err: any) {\n      console.log(err);\n      alert('サインアウトできませんでした')\n    }\n  };\n\n  useEffect(() => {\n    handleGetAllHousehold();\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  return (\n    <>\n      <div className={style.header}>\n        <h1>\n          <Link to='/'>\n            わたしの家計簿\n          </Link>\n        </h1>\n        <div className={style.mobilemenu}>\n          <img \n            onClick={handleModal} \n            className={modalOpen ? style.crossmark : style.mobilemenuBack }\n            src={ modalOpen ? MobileMenuCrossButton : MobileMenuButton } \n            alt='header menu' \n          />\n        </div>\n\n        <ul className={style.pcmenu}>\n          { isSignedIn && households ? <li ><Link to='/'>家計簿を選ぶ</Link></li> : \"\" }\n          <li className={style.sign}>{ isSignedIn ? <span onClick={handleSignout}>サインアウト</span> : <Link to='/signin'>サインイン</Link>}</li>\n        </ul>\n      </div>\n      <MobileModal modalOpen={modalOpen} setModalOpen={setModalOpen} />\n    </>\n  )\n}\n\nexport default Header"]},"metadata":{},"sourceType":"module"}