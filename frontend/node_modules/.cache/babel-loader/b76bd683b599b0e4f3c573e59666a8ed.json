{"ast":null,"code":"import _asyncToGenerator from\"/Users/taiki/Desktop/household/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/taiki/Desktop/household/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/taiki/Desktop/household/frontend/node_modules/@babel/runtime/regenerator/index.js\";import React,{useState,useEffect,createContext}from'react';import{BrowserRouter as Router,Switch,Route,Redirect}from'react-router-dom';// component\nimport Loading from'./components/Loading/Loading';import SignUp from'./components/Auth/SignUp';import SignIn from'./components/Auth/SignIn';import Header from'./components/Header/Header';import HouseHold from'./components/Household/HouseHold';import AddHousehold from'./components/Household/AddHouseHold/AddHousehold';import EditHousehold from'./components/Household/EditHousehold/EditHousehold';import Spending from'./components/Spending/Spending';import AddSpending from'./components/Spending/AddSpending/AddSpending';import EditSpending from'./components/Spending/EditSpending/EditSpending';// api\nimport{getCurrentUser}from'./api/auth';// interface\n// css\nimport style from'./App.module.scss';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var AuthContext=/*#__PURE__*/createContext({});var App=function App(){var _useState=useState(true),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isSignedIn=_useState4[0],setIsSignedIn=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),currentUser=_useState6[0],setCurrentUser=_useState6[1];// 認証済みユーザー情報の取得関数\nvar handleGetCurrentUser=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return getCurrentUser();case 3:res=_context.sent;if((res===null||res===void 0?void 0:res.data.isLogin)===true){setIsSignedIn(true);setCurrentUser(res===null||res===void 0?void 0:res.data.data);console.log(currentUser);}else{console.log(\"No current user\");};_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 11:setLoading(false);case 12:case\"end\":return _context.stop();}}},_callee,null,[[0,8]]);}));return function handleGetCurrentUser(){return _ref.apply(this,arguments);};}();useEffect(function(){handleGetCurrentUser();// eslint-disable-next-line react-hooks/exhaustive-deps\n},[setCurrentUser]);// ユーザー認証済みの判定で表示ページの変更\nvar Private=function Private(_ref2){var children=_ref2.children;if(!loading){if(isSignedIn){return children;}else{return/*#__PURE__*/_jsx(Redirect,{to:\"/signin\"});}}else{return/*#__PURE__*/_jsx(Redirect,{to:\"/loading\"});};};return/*#__PURE__*/_jsx(\"div\",{className:style.body,children:/*#__PURE__*/_jsx(Router,{children:/*#__PURE__*/_jsxs(AuthContext.Provider,{value:{loading:loading,setLoading:setLoading,isSignedIn:isSignedIn,setIsSignedIn:setIsSignedIn,currentUser:currentUser,setCurrentUser:setCurrentUser},children:[/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsxs(Switch,{children:[/*#__PURE__*/_jsx(Route,{exact:true,path:\"/signup\",component:SignUp}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/signin\",component:SignIn}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/loading\",component:Loading}),/*#__PURE__*/_jsx(Private,{children:/*#__PURE__*/_jsxs(Switch,{children:[/*#__PURE__*/_jsx(Route,{exact:true,path:\"/\",component:HouseHold}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/addhousehold\",component:AddHousehold}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/:householdId/edithousehold\",component:EditHousehold}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/:householdId/spendings\",component:Spending}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/:householdId/spendings/addspending\",component:AddSpending}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/:householdId/spendings/:spendingId\",component:EditSpending})]})})]})]})})});};export default App;","map":{"version":3,"sources":["/Users/taiki/Desktop/household/frontend/src/App.tsx"],"names":["React","useState","useEffect","createContext","BrowserRouter","Router","Switch","Route","Redirect","Loading","SignUp","SignIn","Header","HouseHold","AddHousehold","EditHousehold","Spending","AddSpending","EditSpending","getCurrentUser","style","AuthContext","App","loading","setLoading","isSignedIn","setIsSignedIn","currentUser","setCurrentUser","handleGetCurrentUser","res","data","isLogin","console","log","Private","children","body"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, createContext } from 'react';\nimport { BrowserRouter as Router, Switch, Route, Redirect } from 'react-router-dom';\n// component\nimport Loading from './components/Loading/Loading';\nimport SignUp from './components/Auth/SignUp';\nimport SignIn from './components/Auth/SignIn';\nimport Header from './components/Header/Header';\nimport HouseHold from './components/Household/HouseHold';\nimport AddHousehold from './components/Household/AddHouseHold/AddHousehold';\nimport EditHousehold from './components/Household/EditHousehold/EditHousehold';\nimport Spending from './components/Spending/Spending';\nimport AddSpending from './components/Spending/AddSpending/AddSpending';\nimport EditSpending from './components/Spending/EditSpending/EditSpending';\n// api\nimport { getCurrentUser } from './api/auth';\n// interface\nimport { User } from './interface';\n// css\nimport style from './App.module.scss';\n\nexport const AuthContext = createContext(\n  {} as {\n    loading: boolean,\n    setLoading: React.Dispatch<React.SetStateAction<boolean>>,\n    isSignedIn: boolean,\n    setIsSignedIn: React.Dispatch<React.SetStateAction<boolean>>,\n    currentUser: User | undefined,\n    setCurrentUser: React.Dispatch<React.SetStateAction<User | undefined>>,\n  }\n);\n\nconst App: React.FC = () => {\n  const [loading, setLoading] = useState<boolean>(true);\n  const [isSignedIn, setIsSignedIn] = useState<boolean>(false);\n  const [currentUser, setCurrentUser] = useState<User | undefined>();\n  // 認証済みユーザー情報の取得関数\n  const handleGetCurrentUser = async () => {\n    try {\n      const res = await getCurrentUser();\n      if (res?.data.isLogin === true) {\n        setIsSignedIn(true);\n        setCurrentUser(res?.data.data);\n        console.log(currentUser);\n      } else {\n        console.log(\"No current user\");\n      };\n    } catch (err : any) {\n      console.log(err);\n    }\n    setLoading(false)\n  };\n  useEffect(() => {\n    handleGetCurrentUser();\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [setCurrentUser]);\n  // ユーザー認証済みの判定で表示ページの変更\n  const Private = ({ children } :{ children: React.ReactElement } ) => {\n    if (!loading) {\n      if (isSignedIn) {\n        return ( children )\n      } else {\n        return <Redirect to=\"/signin\" />\n      }\n    } else {\n      return <Redirect to=\"/loading\" />\n    };\n  };\n\n  return (\n    <div className={style.body}>\n      <Router>\n        <AuthContext.Provider\n          value={{\n            loading,\n            setLoading,\n            isSignedIn,\n            setIsSignedIn,\n            currentUser,\n            setCurrentUser,\n          }}\n        >\n          <Header />\n          <Switch>\n            <Route exact path=\"/signup\" component={SignUp} />\n            <Route exact path=\"/signin\" component={SignIn} />\n            <Route exact path=\"/loading\" component={Loading} />\n              <Private>\n                <Switch>\n                  <Route exact path=\"/\" component={HouseHold} />\n                  <Route exact path=\"/addhousehold\" component={AddHousehold} />\n                  <Route exact path=\"/:householdId/edithousehold\" component={EditHousehold} />\n                  <Route exact path=\"/:householdId/spendings\" component={Spending} />\n                  <Route exact path=\"/:householdId/spendings/addspending\" component={AddSpending} />\n                  <Route exact path=\"/:householdId/spendings/:spendingId\" component={EditSpending} />\n                </Switch>\n              </Private>\n          </Switch>\n        </AuthContext.Provider>\n      </Router>\n    </div>\n  );\n}\n\nexport default App;"]},"metadata":{},"sourceType":"module"}