{"ast":null,"code":"import _asyncToGenerator from\"/Users/taiki/Desktop/household/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _defineProperty from\"/Users/taiki/Desktop/household/frontend/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"/Users/taiki/Desktop/household/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/Users/taiki/Desktop/household/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/taiki/Desktop/household/frontend/node_modules/@babel/runtime/regenerator/index.js\";import React,{useState,useContext}from'react';import{Link,useHistory,useParams}from'react-router-dom';import{AuthContext}from'../../../App';// css\nimport style from'./AddSpending.module.scss';// api\nimport{createSpending}from'../../../api/spending';// interface\n// image\nimport MemoMark from'../../../image/nameMark.png';import Date from'../../../image/calendar.png';import PriceMark from'../../../image/priceMark.png';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var AddSpending=function AddSpending(){var history=useHistory();var urlParams=useParams();var _useContext=useContext(AuthContext),currentUser=_useContext.currentUser;// 利用履歴初期値\nvar initialSpending={memo:\"\",amountUsed:0,usedAt:\"\"};var _useState=useState(initialSpending),_useState2=_slicedToArray(_useState,2),newSpending=_useState2[0],setNewSpending=_useState2[1];// 入力値の取得\nvar handleInputChange=function handleInputChange(input){return function(e){var target=e.target;setNewSpending(_objectSpread(_objectSpread({},newSpending),{},_defineProperty({},input,target.value)));};};// 利用履歴の新規作成\nvar handleCreateSpending=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var params,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();params={memo:newSpending.memo,amountUsed:newSpending.amountUsed,usedAt:newSpending.usedAt};console.log(params);if(currentUser){_context.next=5;break;}return _context.abrupt(\"return\");case 5:_context.prev=5;_context.next=8;return createSpending(currentUser.id,Number(urlParams.householdId),params);case 8:res=_context.sent;if((res===null||res===void 0?void 0:res.status)===200){console.log('利用履歴登録',res);history.push(\"/\".concat(Number(urlParams.householdId),\"/spendings\"));}_context.next=16;break;case 12:_context.prev=12;_context.t0=_context[\"catch\"](5);console.log('利用履歴登録',_context.t0);alert('登録ができませんでした');case 16:;case 17:case\"end\":return _context.stop();}}},_callee,null,[[5,12]]);}));return function handleCreateSpending(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:style.addspending,children:/*#__PURE__*/_jsxs(\"form\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:style.inputform,children:[/*#__PURE__*/_jsxs(\"div\",{className:style.input,children:[/*#__PURE__*/_jsxs(\"div\",{className:style.inputname,children:[/*#__PURE__*/_jsx(\"img\",{src:Date,alt:\"input usedAt\"}),/*#__PURE__*/_jsx(\"h4\",{children:\"\\u65E5\\u4ED8\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",name:\"usedAt\",required:true,value:newSpending.usedAt,onChange:handleInputChange('usedAt')})]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"div\",{className:style.input,children:[/*#__PURE__*/_jsxs(\"div\",{className:style.inputname,children:[/*#__PURE__*/_jsx(\"img\",{src:PriceMark,alt:\"input amountUsed\"}),/*#__PURE__*/_jsx(\"h4\",{children:\"\\u91D1\\u984D\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"amountUsed\",min:\"0\",required:true,value:newSpending.amountUsed,onChange:handleInputChange('amountUsed')})]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"div\",{className:style.input,children:[/*#__PURE__*/_jsxs(\"div\",{className:style.inputname,children:[/*#__PURE__*/_jsx(\"img\",{src:MemoMark,alt:\"input memo\"}),/*#__PURE__*/_jsx(\"h4\",{children:\"\\u540D\\u524D\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"memo\",required:true,placeholder:\"\\u4F8B: \\u96FB\\u8ECA\\u4EE3\",value:newSpending.memo,onChange:handleInputChange('memo')})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:style.buttonform,children:[/*#__PURE__*/_jsx(\"button\",{className:style.saveButton,onClick:handleCreateSpending,children:\"\\u4FDD\\u5B58\"}),/*#__PURE__*/_jsx(Link,{to:\"/\".concat(Number(urlParams.householdId),\"/spendings\"),className:style.cancelButton,children:\"\\u30AD\\u30E3\\u30F3\\u30BB\\u30EB\"})]})]})})});};export default AddSpending;","map":{"version":3,"sources":["/Users/taiki/Desktop/household/frontend/src/components/Spending/AddSpending/AddSpending.tsx"],"names":["React","useState","useContext","Link","useHistory","useParams","AuthContext","style","createSpending","MemoMark","Date","PriceMark","AddSpending","history","urlParams","currentUser","initialSpending","memo","amountUsed","usedAt","newSpending","setNewSpending","handleInputChange","input","e","target","value","handleCreateSpending","preventDefault","params","console","log","id","Number","householdId","res","status","push","alert","addspending","inputform","inputname","buttonform","saveButton","cancelButton"],"mappings":"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","sourcesContent":["import React, { useState, useContext} from 'react';\nimport { Link, useHistory, useParams } from 'react-router-dom';\nimport { AuthContext } from '../../../App';\n\n// css\nimport style from './AddSpending.module.scss';\n\n// api\nimport { createSpending } from '../../../api/spending';\n\n// interface\nimport { Spending } from '../../../interface';\n\n// image\n  import MemoMark from '../../../image/nameMark.png';\n  import Date from '../../../image/calendar.png';\n  import PriceMark from '../../../image/priceMark.png';\n\nconst AddSpending: React.FC = () => {\n  const history = useHistory();\n  const urlParams = useParams<{householdId: string; spendingId: string}>();\n  const { currentUser } = useContext(AuthContext);\n\n  // 利用履歴初期値\n  const initialSpending = {\n    memo: \"\",\n    amountUsed: 0,\n    usedAt: \"\",\n  };\n  const [newSpending, setNewSpending] = useState(initialSpending);\n\n  // 入力値の取得\n  const handleInputChange = (input: string) => (e: React.ChangeEvent<HTMLInputElement>) => {\n    const target = e.target;\n    setNewSpending({ ...newSpending, [input]: target.value});\n  };\n\n  // 利用履歴の新規作成\n  const handleCreateSpending = async (e: React.MouseEvent<HTMLButtonElement>) => {\n    e.preventDefault();\n\n    const params: Spending ={\n      memo: newSpending.memo,\n      amountUsed: newSpending.amountUsed,\n      usedAt: newSpending.usedAt,\n    }\n    console.log(params);\n    if(!currentUser) return;\n\n    try {\n      const res = await createSpending(currentUser.id, Number(urlParams.householdId), params);\n      if (res?.status === 200) {\n        console.log('利用履歴登録', res);\n        history.push(`/${Number(urlParams.householdId)}/spendings`);\n      }\n    } catch (err :any) {\n      console.log('利用履歴登録', err)\n      alert('登録ができませんでした')\n    };\n  };\n\n  return (\n    <>\n      <div className={style.addspending}>\n        <form>\n          <div className={style.inputform}>\n            <div className={style.input}>\n              <div className={style.inputname}>\n                <img src={Date} alt='input usedAt' />\n                <h4>日付</h4>\n              </div>\n              <input \n                type='date'\n                name='usedAt'\n                required\n                value={newSpending.usedAt}\n                onChange={handleInputChange('usedAt')}\n              />\n            </div>\n            <hr />\n            <div className={style.input}>\n              <div className={style.inputname}>\n                <img src={PriceMark} alt='input amountUsed' />\n                <h4>金額</h4>\n              </div>\n              <input \n                type='number'\n                name='amountUsed'\n                min='0'\n                required\n                value={newSpending.amountUsed}\n                onChange={handleInputChange('amountUsed')}\n              />\n            </div>\n            <hr />\n            <div className={style.input}>\n              <div className={style.inputname}>\n                <img src={MemoMark} alt='input memo' />\n                <h4>名前</h4>\n              </div>\n              <input \n                type='text'\n                name='memo'\n                required\n                placeholder='例: 電車代'\n                value={newSpending.memo}\n                onChange={handleInputChange('memo')}\n              />\n            </div>\n          </div>\n          <div className={style.buttonform}>\n            <button \n              className={style.saveButton}\n              onClick={handleCreateSpending}\n            >\n              保存\n            </button>\n            <Link to={`/${Number(urlParams.householdId)}/spendings`} className={style.cancelButton}>\n                キャンセル\n            </Link>\n          </div>\n        </form>\n      </div>\n    </>\n  )\n}\n\nexport default AddSpending"]},"metadata":{},"sourceType":"module"}