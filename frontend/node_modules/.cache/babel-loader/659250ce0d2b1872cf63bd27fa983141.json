{"ast":null,"code":"import _asyncToGenerator from\"/Users/taiki/Desktop/household/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/taiki/Desktop/household/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/taiki/Desktop/household/frontend/node_modules/@babel/runtime/regenerator/index.js\";import React,{useState,useEffect,useContext}from'react';import Cookies from'js-cookie';import{Link,useHistory}from'react-router-dom';import{AuthContext}from'../../../App';// api\nimport{getAllHousehold}from'../../../api/household';// component\nimport{signOut}from'../../../api/auth';// css\nimport style from'./MobileModal.module.scss';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var MobileModal=function MobileModal(props){var modalOpen=props.modalOpen,setModalOpen=props.setModalOpen;var history=useHistory();var _useContext=useContext(AuthContext),isSignedIn=_useContext.isSignedIn,setIsSignedIn=_useContext.setIsSignedIn,currentUser=_useContext.currentUser;var initialHousehold={id:1,name:\"\",amountPlanned:1,userId:0,createdAt:new Date(),updatedAt:new Date()};var _useState=useState([initialHousehold]),_useState2=_slicedToArray(_useState,2),households=_useState2[0],setHouseholds=_useState2[1];// 家計簿一覧の取得\nvar handleGetAllHousehold=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(currentUser){_context.next=2;break;}return _context.abrupt(\"return\");case 2:_context.prev=2;_context.next=5;return getAllHousehold(currentUser.id);case 5:res=_context.sent;if((res===null||res===void 0?void 0:res.status)===200){setHouseholds(res.data);};_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](2);console.log(_context.t0);case 13:case\"end\":return _context.stop();}}},_callee,null,[[2,10]]);}));return function handleGetAllHousehold(){return _ref.apply(this,arguments);};}();var handleModal=function handleModal(){setModalOpen(!modalOpen);};var handleSignout=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return signOut();case 3:res=_context2.sent;if(res.data.success===true){Cookies.remove(\"_access_token\");Cookies.remove(\"_client\");Cookies.remove(\"_uid\");setIsSignedIn(false);history.push(\"/signin\");console.log('サインアウトしました');}else{console.log('サインアウトに失敗しました');alert('サインアウトできませんでした');}_context2.next=11;break;case 7:_context2.prev=7;_context2.t0=_context2[\"catch\"](0);console.log(_context2.t0);alert('サインアウトできませんでした');case 11:;setModalOpen(false);case 13:case\"end\":return _context2.stop();}}},_callee2,null,[[0,7]]);}));return function handleSignout(){return _ref2.apply(this,arguments);};}();useEffect(function(){handleGetAllHousehold();// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"\".concat(style.mobilemodal,\" \").concat(modalOpen?style.openmodal:''),children:/*#__PURE__*/_jsx(\"div\",{className:style.inner,children:/*#__PURE__*/_jsxs(\"div\",{className:style.list,children:[isSignedIn&&households?/*#__PURE__*/_jsx(\"p\",{children:/*#__PURE__*/_jsx(Link,{to:\"/\",children:/*#__PURE__*/_jsxs(\"span\",{onClick:function onClick(){return setModalOpen(false);},children:[\"\\u5BB6\\u8A08\\u7C3F\\u3092\",/*#__PURE__*/_jsx(\"br\",{}),\"\\u9078\\u3076\"]})})}):\"\",isSignedIn?/*#__PURE__*/_jsxs(\"p\",{onClick:handleSignout,children:[\"\\u30B5\\u30A4\\u30F3\",/*#__PURE__*/_jsx(\"br\",{}),\"\\u30A2\\u30A6\\u30C8\"]}):/*#__PURE__*/_jsx(\"p\",{children:/*#__PURE__*/_jsxs(Link,{to:\"/singin\",children:[\"\\u30B5\\u30A4\\u30F3\",/*#__PURE__*/_jsx(\"br\",{}),\"\\u30A4\\u30F3\"]})})]})})}),/*#__PURE__*/_jsx(\"div\",{className:\"\".concat(style.modalback,\" \").concat(modalOpen?style.modalback_open:''),onClick:handleModal})]});};export default MobileModal;","map":{"version":3,"sources":["/Users/taiki/Desktop/household/frontend/src/components/Header/MobileModal/MobileModal.tsx"],"names":["React","useState","useEffect","useContext","Cookies","Link","useHistory","AuthContext","getAllHousehold","signOut","style","MobileModal","props","modalOpen","setModalOpen","history","isSignedIn","setIsSignedIn","currentUser","initialHousehold","id","name","amountPlanned","userId","createdAt","Date","updatedAt","households","setHouseholds","handleGetAllHousehold","res","status","data","console","log","handleModal","handleSignout","success","remove","push","alert","mobilemodal","openmodal","inner","list","modalback","modalback_open"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useContext } from 'react';\nimport Cookies from 'js-cookie';\nimport { Link, useHistory } from 'react-router-dom';\nimport { AuthContext } from '../../../App';\n\n// api\nimport { getAllHousehold } from '../../../api/household';\n\n// component\nimport { signOut } from '../../../api/auth';\n\n// css\nimport style from './MobileModal.module.scss';\n\n\ntype Props = {\n  modalOpen: boolean;\n  setModalOpen: React.Dispatch<React.SetStateAction<boolean>>;\n};\n\nconst MobileModal: React.FC<Props> = (props) => {\n  const {\n    modalOpen,\n    setModalOpen\n  } = props;\n\n  const history = useHistory();\n  const { \n    isSignedIn, \n    setIsSignedIn,\n    currentUser\n  } = useContext(AuthContext);\n\n  const initialHousehold = {\n    id: 1,\n    name: \"\",\n    amountPlanned: 1,\n    userId: 0,\n    createdAt: new Date(),\n    updatedAt: new Date()\n  };\n\n  const [households, setHouseholds] = useState([initialHousehold]);\n\n  // 家計簿一覧の取得\n  const handleGetAllHousehold = async () => {\n    if(!currentUser) return;\n    try {\n      const res = await getAllHousehold(currentUser.id);\n      if(res?.status === 200) {\n        setHouseholds(res.data);\n      };\n    } catch (err: any) {\n      console.log(err);\n    }\n  };\n\n  const handleModal = () => {\n    setModalOpen(!modalOpen);\n  };\n\n  const handleSignout = async () => {\n    try {\n      const res = await signOut();\n  \n      if(res.data.success === true) {\n        Cookies.remove(\"_access_token\");\n        Cookies.remove(\"_client\");\n        Cookies.remove(\"_uid\");\n  \n        setIsSignedIn(false);\n        history.push(\"/signin\");\n  \n        console.log('サインアウトしました')\n      } else {\n        console.log('サインアウトに失敗しました')\n        alert('サインアウトできませんでした')\n      }\n    } catch (err: any) {\n      console.log(err);\n      alert('サインアウトできませんでした')\n    };\n\n    setModalOpen(false);\n  };\n\n  useEffect(() => {\n    handleGetAllHousehold();\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  return (\n    <div>\n      <div className={`${style.mobilemodal} ${ modalOpen ? style.openmodal : '' }`}>\n        <div className={style.inner}>\n          <div className={style.list}>\n            { isSignedIn && households\n              ?\n                <p>\n                  <Link to='/'>\n                    <span onClick={() => setModalOpen(false)}>\n                      家計簿を<br />選ぶ\n                    </span>\n                  </Link>\n                </p>\n              : \n                \"\"\n            }\n            { isSignedIn ? <p onClick={handleSignout}>サイン<br />アウト</p> : <p><Link to='/singin'>サイン<br />イン</Link></p> }\n          </div>\n        </div>\n      </div>\n      <div \n        className={`${style.modalback} ${ modalOpen ? style.modalback_open : '' }`} \n        onClick={handleModal}\n      >\n      </div>\n    </div>\n  )\n}\n\nexport default MobileModal"]},"metadata":{},"sourceType":"module"}