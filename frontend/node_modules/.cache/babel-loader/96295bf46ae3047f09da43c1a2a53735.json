{"ast":null,"code":"import _asyncToGenerator from\"/Users/taiki/Desktop/household/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _defineProperty from\"/Users/taiki/Desktop/household/frontend/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"/Users/taiki/Desktop/household/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/Users/taiki/Desktop/household/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/taiki/Desktop/household/frontend/node_modules/@babel/runtime/regenerator/index.js\";import React,{useState,useEffect,useContext}from'react';import{Link,useHistory,useParams}from'react-router-dom';import{AuthContext}from'../../../App';// function\n// css\nimport style from'./EditSpending.module.scss';// api\nimport{updateSpending,getSpending,deleteSpending}from'../../../api/spending';// interface\n// image\nimport MemoMark from'../../../image/nameMark.png';import Date from'../../../image/calendar.png';import PriceMark from'../../../image/priceMark.png';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var EditSpending=function EditSpending(){var history=useHistory();var urlParams=useParams();var _useContext=useContext(AuthContext),currentUser=_useContext.currentUser;// const width = useWindowDimensions();\n// 利用履歴初期値\nvar initialSpending={memo:\"\",amountUsed:0,usedAt:\"\"};var _useState=useState(initialSpending),_useState2=_slicedToArray(_useState,2),currentSpending=_useState2[0],setCurrentSpending=_useState2[1];// 入力値の取得\nvar handleInputChange=function handleInputChange(input){return function(e){var target=e.target;setCurrentSpending(_objectSpread(_objectSpread({},currentSpending),{},_defineProperty({},input,target.value)));};};// 利用履歴の編集\nvar handleUpdateSpending=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var params,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();params={memo:currentSpending.memo,amountUsed:currentSpending.amountUsed,usedAt:currentSpending.usedAt};console.log(params);if(currentUser){_context.next=5;break;}return _context.abrupt(\"return\");case 5:_context.prev=5;_context.next=8;return updateSpending(currentUser.id,Number(urlParams.householdId),Number(urlParams.spendingId),params);case 8:res=_context.sent;if((res===null||res===void 0?void 0:res.status)===200){console.log('利用履歴編集',res);history.push(\"/\".concat(Number(urlParams.householdId),\"/spendings\"));}_context.next=16;break;case 12:_context.prev=12;_context.t0=_context[\"catch\"](5);console.log('利用履歴編集',_context.t0);alert('登録ができませんでした');case 16:;case 17:case\"end\":return _context.stop();}}},_callee,null,[[5,12]]);}));return function handleUpdateSpending(_x){return _ref.apply(this,arguments);};}();// 利用履歴詳細の取得\nvar handleGetSpending=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(currentUser){_context2.next=2;break;}return _context2.abrupt(\"return\");case 2:_context2.prev=2;_context2.next=5;return getSpending(currentUser.id,Number(urlParams.householdId),Number(urlParams.spendingId));case 5:res=_context2.sent;console.log('利用履歴詳細',res===null||res===void 0?void 0:res.data);setCurrentSpending(res===null||res===void 0?void 0:res.data);_context2.next=13;break;case 10:_context2.prev=10;_context2.t0=_context2[\"catch\"](2);console.log('利用履歴詳細',_context2.t0);case 13:;case 14:case\"end\":return _context2.stop();}}},_callee2,null,[[2,10]]);}));return function handleGetSpending(){return _ref2.apply(this,arguments);};}();// 利用履歴の削除\nvar handleDeleteSpending=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(e){var sure,res;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:e.preventDefault();if(currentUser){_context3.next=3;break;}return _context3.abrupt(\"return\");case 3:sure=window.confirm('削除してよろしいですか?');if(sure){_context3.next=6;break;}return _context3.abrupt(\"return\");case 6:_context3.prev=6;_context3.next=9;return deleteSpending(currentUser.id,Number(urlParams.householdId),Number(urlParams.spendingId));case 9:res=_context3.sent;console.log('利用履歴削除',res);history.push(\"/\".concat(Number(urlParams.householdId),\"/spendings\"));_context3.next=18;break;case 14:_context3.prev=14;_context3.t0=_context3[\"catch\"](6);console.log(_context3.t0);alert('削除ができませんでした');case 18:;case 19:case\"end\":return _context3.stop();}}},_callee3,null,[[6,14]]);}));return function handleDeleteSpending(_x2){return _ref3.apply(this,arguments);};}();useEffect(function(){handleGetSpending();// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:style.addspending,children:/*#__PURE__*/_jsxs(\"form\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:style.inputform,children:[/*#__PURE__*/_jsxs(\"div\",{className:style.input,children:[/*#__PURE__*/_jsxs(\"div\",{className:style.inputname,children:[/*#__PURE__*/_jsx(\"img\",{src:Date,alt:\"input usedAt\"}),/*#__PURE__*/_jsx(\"h4\",{children:\"\\u65E5\\u4ED8\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",name:\"usedAt\",required:true,value:currentSpending.usedAt,onChange:handleInputChange('usedAt')})]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"div\",{className:style.input,children:[/*#__PURE__*/_jsxs(\"div\",{className:style.inputname,children:[/*#__PURE__*/_jsx(\"img\",{src:PriceMark,alt:\"input amountUsed\"}),/*#__PURE__*/_jsx(\"h4\",{children:\"\\u91D1\\u984D\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"amountUsed\",min:\"0\",required:true,value:currentSpending.amountUsed,onChange:handleInputChange('amountUsed')})]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"div\",{className:style.input,children:[/*#__PURE__*/_jsxs(\"div\",{className:style.inputname,children:[/*#__PURE__*/_jsx(\"img\",{src:MemoMark,alt:\"input memo\"}),/*#__PURE__*/_jsx(\"h4\",{children:\"\\u540D\\u524D\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"memo\",required:true,placeholder:\"\\u4F8B: \\u96FB\\u8ECA\\u4EE3\",value:currentSpending.memo,onChange:handleInputChange('memo')})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:style.buttonform,children:[/*#__PURE__*/_jsx(\"button\",{className:style.saveButton,onClick:handleUpdateSpending,children:\"\\u4FDD\\u5B58\"}),/*#__PURE__*/_jsxs(\"div\",{className:style.button_cancels,children:[/*#__PURE__*/_jsx(\"button\",{className:style.button_delete,onClick:handleDeleteSpending,children:\"\\u5C65\\u6B74\\u3092\\u524A\\u9664\"}),/*#__PURE__*/_jsx(Link,{to:\"/\".concat(Number(urlParams.householdId),\"/spendings\"),className:style.button_cancel,children:\"\\u30AD\\u30E3\\u30F3\\u30BB\\u30EB\"})]})]})]})})});};export default EditSpending;","map":{"version":3,"sources":["/Users/taiki/Desktop/household/frontend/src/components/Spending/EditSpending/EditSpending.tsx"],"names":["React","useState","useEffect","useContext","Link","useHistory","useParams","AuthContext","style","updateSpending","getSpending","deleteSpending","MemoMark","Date","PriceMark","EditSpending","history","urlParams","currentUser","initialSpending","memo","amountUsed","usedAt","currentSpending","setCurrentSpending","handleInputChange","input","e","target","value","handleUpdateSpending","preventDefault","params","console","log","id","Number","householdId","spendingId","res","status","push","alert","handleGetSpending","data","handleDeleteSpending","sure","window","confirm","addspending","inputform","inputname","buttonform","saveButton","button_cancels","button_delete","button_cancel"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useContext} from 'react';\nimport { Link, useHistory, useParams } from 'react-router-dom';\nimport { AuthContext } from '../../../App';\n\n// function\nimport { useWindowDimensions } from '../../../function/window';\n\n// css\nimport style from './EditSpending.module.scss';\n\n// api\nimport { updateSpending, getSpending, deleteSpending } from '../../../api/spending';\n\n// interface\nimport { Spending } from '../../../interface';\n\n// image\n  import MemoMark from '../../../image/nameMark.png';\n  import Date from '../../../image/calendar.png';\n  import PriceMark from '../../../image/priceMark.png';\n\nconst EditSpending: React.FC = () => {\n  const history = useHistory();\n  const urlParams = useParams<{householdId: string; spendingId: string}>();\n  const { currentUser } = useContext(AuthContext);\n  // const width = useWindowDimensions();\n\n  // 利用履歴初期値\n  const initialSpending = {\n    memo: \"\",\n    amountUsed: 0,\n    usedAt: \"\",\n  };\n  const [currentSpending, setCurrentSpending] = useState(initialSpending);\n\n  // 入力値の取得\n  const handleInputChange = (input: string) => (e: React.ChangeEvent<HTMLInputElement>) => {\n    const target = e.target;\n    setCurrentSpending({ ...currentSpending, [input]: target.value});\n  };\n\n  // 利用履歴の編集\n  const handleUpdateSpending = async (e: React.MouseEvent<HTMLButtonElement>) => {\n    e.preventDefault();\n\n    const params: Spending ={\n      memo: currentSpending.memo,\n      amountUsed: currentSpending.amountUsed,\n      usedAt: currentSpending.usedAt,\n    }\n    console.log(params);\n    if(!currentUser) return;\n\n    try {\n      const res = await updateSpending(\n        currentUser.id,\n        Number(urlParams.householdId),\n        Number(urlParams.spendingId), \n        params\n      );\n\n      if (res?.status === 200) {\n        console.log('利用履歴編集', res);\n        history.push(`/${Number(urlParams.householdId)}/spendings`);\n      }\n    } catch (err :any) {\n      console.log('利用履歴編集', err);\n      alert('登録ができませんでした');\n    };\n\n  };\n\n  // 利用履歴詳細の取得\n  const handleGetSpending = async () => {\n    if (!currentUser) return;\n    try {\n      const res = await getSpending(\n        currentUser.id,\n        Number(urlParams.householdId),\n        Number(urlParams.spendingId)\n      );\n\n      console.log('利用履歴詳細', res?.data);\n      setCurrentSpending(res?.data);\n    } catch (err :any) {\n      console.log('利用履歴詳細', err)\n    };\n  };\n\n  // 利用履歴の削除\n  const handleDeleteSpending = async (e: React.MouseEvent<HTMLButtonElement>) => {\n    e.preventDefault();\n\n    if (!currentUser) return;\n    const sure = window.confirm('削除してよろしいですか?')\n    if (!sure) return;\n    try {\n      const res = await deleteSpending(\n        currentUser.id,\n        Number(urlParams.householdId),\n        Number(urlParams.spendingId)\n      );\n      console.log('利用履歴削除', res);\n      history.push(`/${Number(urlParams.householdId)}/spendings`);\n    } catch (err: any) {\n      console.log(err);\n      alert('削除ができませんでした');\n    };\n  };\n\n  useEffect(() => {\n    handleGetSpending();\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n\n  return (\n    <>\n      <div className={style.addspending}>\n\n        <form>\n          <div className={style.inputform}>\n            <div className={style.input}>\n              <div className={style.inputname}>\n                <img src={Date} alt='input usedAt' />\n                <h4>日付</h4>\n              </div>\n              <input \n                type='date'\n                name='usedAt'\n                required\n                value={currentSpending.usedAt}\n                onChange={handleInputChange('usedAt')}\n              />\n            </div>\n            <hr />\n            <div className={style.input}>\n              <div className={style.inputname}>\n                <img src={PriceMark} alt='input amountUsed' />\n                <h4>金額</h4>\n              </div>\n              <input \n                type='number'\n                name='amountUsed'\n                min='0'\n                required\n                value={currentSpending.amountUsed}\n                onChange={handleInputChange('amountUsed')}\n              />\n            </div>\n            <hr />\n            <div className={style.input}>\n              <div className={style.inputname}>\n                <img src={MemoMark} alt='input memo' />\n                <h4>名前</h4>\n              </div>\n              <input \n                type='text'\n                name='memo'\n                required\n                placeholder='例: 電車代'\n                value={currentSpending.memo}\n                onChange={handleInputChange('memo')}\n              />\n            </div>\n          </div>\n          <div className={style.buttonform}>\n            <button \n              className={style.saveButton}\n              onClick={handleUpdateSpending}\n            >\n              保存\n            </button>\n            <div className={style.button_cancels}>\n              <button\n                className={style.button_delete}\n                onClick={handleDeleteSpending}\n              >\n                履歴を削除\n              </button>\n              <Link \n                to={`/${Number(urlParams.householdId)}/spendings`} \n                className={style.button_cancel}\n              >\n                キャンセル\n              </Link>\n            </div>\n          </div>\n        </form>\n      </div>\n    </>\n  )\n}\n\nexport default EditSpending"]},"metadata":{},"sourceType":"module"}