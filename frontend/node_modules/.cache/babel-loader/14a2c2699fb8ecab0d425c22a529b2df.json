{"ast":null,"code":"import _asyncToGenerator from\"/Users/taiki/Desktop/household/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/taiki/Desktop/household/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/taiki/Desktop/household/frontend/node_modules/@babel/runtime/regenerator/index.js\";import React,{useState,useContext}from'react';import{useHistory,Link}from'react-router-dom';import Cookies from'js-cookie';import{AuthContext}from'../../App';// api\nimport{signIn}from'../../api/auth';// interface\n// image\nimport SignButton from'../../image/sign_button.png';// css\nimport style from'./Sign.module.scss';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var SignIn=function SignIn(){var history=useHistory();var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),email=_useState2[0],setEmail=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var _useContext=useContext(AuthContext),setIsSignedIn=_useContext.setIsSignedIn,setCurrentUser=_useContext.setCurrentUser;var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var params,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();params={email:email,password:password};_context.prev=2;_context.next=5;return signIn(params);case 5:res=_context.sent;if(res.status===200){Cookies.set(\"_access_token\",res.headers[\"access-token\"]);Cookies.set(\"_client\",res.headers[\"client\"]);Cookies.set(\"_uid\",res.headers[\"uid\"]);setIsSignedIn(true);setCurrentUser(res.data.data);history.push(\"/\");console.log(\"サインインしました\");}else{alert(\"サインインできませんでした\");}_context.next=13;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](2);alert(\"サインインできませんでした\");console.log(_context.t0);case 13:;case 14:case\"end\":return _context.stop();}}},_callee,null,[[2,9]]);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:style.sign,children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u767B\\u9332\\u3057\\u305F\\u30E1\\u30FC\\u30EB\\u30FB\\u30D1\\u30B9\\u30EF\\u30FC\\u30C9\\u3092\\u5165\\u529B\"}),/*#__PURE__*/_jsx(\"div\",{className:style.container,children:/*#__PURE__*/_jsxs(\"form\",{className:style.signform,children:[/*#__PURE__*/_jsxs(\"div\",{className:style.input,children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\u30E1\\u30FC\\u30EB\\u30A2\\u30C9\\u30EC\\u30B9\"}),/*#__PURE__*/_jsx(\"input\",{name:\"email\",required:true,type:\"email\",placeholder:\"\\u30E1\\u30FC\\u30EB\\u30A2\\u30C9\\u30EC\\u30B9\\u3092\\u5165\\u529B\\u3057\\u3066\\u304F\\u3060\\u3055\\u3044\",value:email,onChange:function onChange(e){return setEmail(e.target.value);}})]}),/*#__PURE__*/_jsxs(\"div\",{className:style.input,children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\u30D1\\u30B9\\u30EF\\u30FC\\u30C9\"}),/*#__PURE__*/_jsx(\"input\",{name:\"password\",required:true,type:\"text\",placeholder:\"\\u30D1\\u30B9\\u30EF\\u30FC\\u30C9\\u3092\\u5165\\u529B\\u3057\\u3066\\u304F\\u3060\\u3055\\u3044\",value:password,onChange:function onChange(e){return setPassword(e.target.value);}})]}),/*#__PURE__*/_jsxs(\"button\",{disabled:!email||!password?true:false,onClick:handleSubmit,children:[/*#__PURE__*/_jsx(\"img\",{src:SignButton,alt:\"sign button\"}),\"\\u30B5\\u30A4\\u30F3\\u30A4\\u30F3\"]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:style.changebutton,children:[\"\\u767B\\u9332\\u3057\\u3066\\u3044\\u306A\\u3044\\u5834\\u5408\\u306F\",/*#__PURE__*/_jsx(Link,{to:\"/signup\",children:\"\\u3053\\u3061\\u3089\"})]})]});};export default SignIn;","map":{"version":3,"sources":["/Users/taiki/Desktop/household/frontend/src/components/Auth/SignIn.tsx"],"names":["React","useState","useContext","useHistory","Link","Cookies","AuthContext","signIn","SignButton","style","SignIn","history","email","setEmail","password","setPassword","setIsSignedIn","setCurrentUser","handleSubmit","e","preventDefault","params","res","status","set","headers","data","push","console","log","alert","sign","container","signform","input","target","value","changebutton"],"mappings":"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","sourcesContent":["import React, { useState, useContext } from 'react';\nimport { useHistory, Link } from 'react-router-dom';\nimport Cookies from 'js-cookie';\nimport { AuthContext } from '../../App';\n\n// api\nimport { signIn } from '../../api/auth';\n\n// interface\nimport { SignInParams } from '../../interface';\n\n// image\nimport SignButton from '../../image/sign_button.png';\n\n// css\nimport style from './Sign.module.scss';\n\nconst SignIn: React.FC = () => {\n  const history = useHistory();\n\n  const [email, setEmail] = useState<string>(\"\");\n  const [password, setPassword] = useState<string>(\"\");\n\n  const { setIsSignedIn, setCurrentUser } = useContext(AuthContext);\n\n  const handleSubmit = async (e: React.MouseEvent<HTMLButtonElement>) => {\n    e.preventDefault();\n\n    const params: SignInParams = {\n      email: email,\n      password: password,\n    };\n\n    try {\n      const res = await signIn(params);\n\n      if (res.status === 200) {\n        Cookies.set(\"_access_token\", res.headers[\"access-token\"]);\n        Cookies.set(\"_client\", res.headers[\"client\"]);\n        Cookies.set(\"_uid\", res.headers[\"uid\"]);\n\n        setIsSignedIn(true);\n        setCurrentUser(res.data.data);\n\n        history.push(\"/\");\n\n        console.log(\"サインインしました\");\n      } else {\n        alert(\"サインインできませんでした\")\n      }\n    } catch (err: any) {\n      alert(\"サインインできませんでした\")\n      console.log(err);\n    };\n  };\n\n\n  return (\n    <div className={style.sign}>\n      <h2>登録したメール・パスワードを入力</h2>\n      <div className={style.container}>\n        <form className={style.signform}>\n          <div className={style.input}>\n            <h3>メールアドレス</h3>\n            <input \n              name=\"email\"\n              required\n              type=\"email\"\n              placeholder='メールアドレスを入力してください'\n              value={email}\n              onChange={e => setEmail(e.target.value)}\n            />\n          </div>\n          <div className={style.input}>\n            <h3>パスワード</h3>\n            <input \n              name=\"password\"\n              required\n              type=\"text\"\n              placeholder='パスワードを入力してください'\n              value={password}\n              onChange={e => setPassword(e.target.value)}\n            />\n          </div>\n          <button\n            disabled={\n              !email || !password\n              ? true\n              : false\n            }\n            onClick={handleSubmit}\n          >\n            <img src={SignButton} alt=\"sign button\" />\n            サインイン\n          </button>\n        </form>\n      </div>\n      <div className={style.changebutton}>\n        登録していない場合は\n        <Link to=\"/signup\">\n            こちら\n        </Link>\n      </div>\n    </div>\n  )\n}\n\nexport default SignIn"]},"metadata":{},"sourceType":"module"}